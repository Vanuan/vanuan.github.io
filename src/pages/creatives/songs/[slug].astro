---
import { getCollection } from "astro:content";
import Layout from "../../../layouts/Layout.astro";

export async function getStaticPaths() {
    const songs = await getCollection("songs");
    return songs.map((song) => ({
        params: { slug: song.slug },
        props: { song },
    }));
}

interface Props {
    song: {
        id: string;
        slug: string;
        body: string;
        collection: string;
        data: {
            title: string;
            description: string;
            publishDate: Date;
            genre?: string;
            tags?: string[];
        };
    };
}

const { song } = Astro.props;
const { Content } = await song.render();
---

<Layout title={`${song.data.title} | Songs | Creatives`} description={song.data.description}>
    <article class="max-w-4xl mx-auto py-8">
        <!-- Header Section -->
        <header class="mb-8 border-b border-gray-200 dark:border-gray-700 pb-6">
            <div class="flex items-center gap-4 mb-4">
                <div class="bg-purple-100 dark:bg-purple-900/30 p-3 rounded-lg">
                    <svg class="w-6 h-6 text-purple-600 dark:text-purple-400" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M9.383 3.076A1 1 0 0110 4v12a1 1 0 01-1.707.707L4.586 13H2a1 1 0 01-1-1V8a1 1 0 011-1h2.586l3.707-3.707a1 1 0 011.09-.217zM15.657 6.343a1 1 0 011.414 0A9.972 9.972 0 0119 12a9.972 9.972 0 01-1.929 5.657 1 1 0 11-1.414-1.414A7.971 7.971 0 0017 12c0-2.21-.894-4.208-2.343-5.657a1 1 0 010-1.414zm-2.829 2.829a1 1 0 011.414 0A5.983 5.983 0 0115 12a5.983 5.983 0 01-.758 2.828 1 1 0 11-1.414-1.414A3.987 3.987 0 0013 12a3.987 3.987 0 00-.172-1.414 1 1 0 010-1.414z" clip-rule="evenodd"></path>
                    </svg>
                </div>
                <h1 class="text-4xl lg:text-5xl font-bold leading-tight text-gray-900 dark:text-white">
                    {song.data.title}
                </h1>
            </div>
            <p class="text-lg text-gray-600 dark:text-gray-300 mb-4 leading-relaxed">
                {song.data.description}
            </p>
            <div class="flex flex-wrap items-center gap-4 text-sm text-gray-500 dark:text-gray-400">
                <time datetime={song.data.publishDate.toISOString()}>
                    Published on {new Date(song.data.publishDate).toLocaleDateString('en-US', {
                        year: 'numeric',
                        month: 'long',
                        day: 'numeric'
                    })}
                </time>
                {song.data.genre && (
                    <span class="bg-purple-100 dark:bg-purple-900/30 text-purple-800 dark:text-purple-300 px-3 py-1 rounded-full text-xs font-medium">
                        {song.data.genre}
                    </span>
                )}
                {song.data.tags && song.data.tags.length > 0 && (
                    <div class="flex flex-wrap gap-2">
                        {song.data.tags.map((tag) => (
                            <span class="bg-gray-100 dark:bg-gray-700 text-gray-700 dark:text-gray-300 px-2 py-1 rounded-md text-xs">
                                #{tag}
                            </span>
                        ))}
                    </div>
                )}
            </div>
        </header>

        <!-- Content Section -->
        <div class="prose prose-lg dark:prose-invert max-w-none prose-headings:scroll-mt-20">
            <Content />
        </div>

        <!-- Navigation -->
        <footer class="mt-12 pt-8 border-t border-gray-200 dark:border-gray-700">
            <div class="flex justify-between items-center">
                <a
                    href="/creatives/songs"
                    class="inline-flex items-center text-gray-600 dark:text-gray-400 hover:text-gray-900 dark:hover:text-white transition-colors duration-200"
                >
                    <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7"></path>
                    </svg>
                    Back to Songs
                </a>
                <a
                    href="/creatives"
                    class="inline-flex items-center text-purple-600 dark:text-purple-400 hover:text-purple-800 dark:hover:text-purple-300 transition-colors duration-200"
                >
                    All Creatives
                    <svg class="w-4 h-4 ml-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"></path>
                    </svg>
                </a>
            </div>
        </footer>
    </article>
</Layout>
